sword2 <- c(stopwords('en'), "and","but","not")
corp2 <- tm_map(corp2, removeWords,sword2)
View(corp2)
corp1 <- Corpus(VectorSource(hh4))
corp1
inspect(corp1)
corp2 <- tm_map(corp1, stripWhitespace)
corp2 <- tm_map(corp2, tolower)
corp2 <- tm_map(corp2, removeNumbers)
corp2 <- tm_map(corp2, PlainTextDocument)
sword2 <- c(stopwords('en'), "and","but","not")
corp2 <- tm_map(corp2, removeWords,sword2)
tdm <- TermDocumentMatrix(corp2)
corp1 <- VCorpus(VectorSource(hh4))
corp2 <- tm_map(corp1, stripWhitespace)
corp2 <- tm_map(corp2, tolower)
corp2 <- tm_map(corp2, removeNumbers)
corp2 <- tm_map(corp2, PlainTextDocument)
sword2 <- c(stopwords('en'), "and","but","not")
corp2 <- tm_map(corp2, removeWords,sword2)
View(corp2)
tdm <- TermDocumentMatrix(corp2)
tdm
corp3 <- as.matrix(corp2)
tdm <- TermDocumentMatrix(corp2,control = list(wordLength=c(1,Inf)))
corp3 <- as.matrix(tdm)
freq1 <- sort(rowSums(corp3),decreasing = T)
freq2 <- sort(colSums(corp3),decreasing = T)
dim((corp3))
colnames(corp3) <- c(1:3732)
library(RColorBrewer)
palete <- brewer.pal(11, "Set3")
wordcloud2(names(freq1),freq = freq1,sclae=c(11,1))
wordcloud2(names(freq1),freq = freq1)
wordcloud2(names(freq1))
wordcloud2(names(corp3))
wordcloud2(names(freq1),freq=freq1 , scale =c(11,1), min.freq=5,colors=palete,random.order=F,
random.color=T)
library(wordcloud)
wordcloud(names(freq1),freq=freq1 , scale =c(11,1), min.freq=5,colors=palete,random.order=F,
random.color=T)
unlist(corp2)
View(freq1)
View(freq2)
View(freq1)
wordcount <- table(freq1)
wordcount
unlist(freq1)
wordcount <- table(hh4)
wordcount
head(sort(wordcount, decreasing = T))
head(sort(wordcount, decreasing = T),100)
tolower(hh4)
hh5 <- tolower(hh4)
wordcount <- table(hh5)
head(sort(wordcount, decreasing = T),100)
hh <- readLines("hiphop.txt")
hh1
hh1 <- gsub("'\n'","", hh)
hh1 <- gsub("\'", "", hh1)
hh1 <- gsub("'", "", hh1)
hh2 <- sapply(hh1, extractNoun,USE.NAMES = F)
hh4 <- Filter(function(x) {nchar(x) >= 2},hh4)
hh2 <- Filter(function(x) {nchar(x) >= 2},hh2)
hh2 <- unlist(hh2)
hh2
hh2 <- Filter(function(x) {nchar(x) >= 2},hh2)
hh2
hh2 <- tolower(hh2)
hh <- readLines("hiphop.txt")
hh1 <- gsub("'\n'","", hh)
hh1 <- gsub("\'", "", hh1)
hh1 <- gsub("'", "", hh1)
hh2 <- tolower(hh2)
hh <- readLines("hiphop.txt")
hh1 <- gsub("'\n'","", hh)
hh1 <- gsub("\'", "", hh1)
hh1 <- gsub("'", "", hh1)
hh2 <- tolower(hh1)
hh2 <- sapply(hh1, extractNoun,USE.NAMES = F)
hh2 <- Filter(function(x) {nchar(x) >= 2},hh2)
hh2
hh2 <- sapply(hh2, extractNoun,USE.NAMES = F)
hh2 <- sapply(hh2, extractNoun,USE.NAMES = F)
hh <- readLines("hiphop.txt")
hh1 <- gsub("'\n'","", hh)
hh1 <- gsub("\'", "", hh1)
hh1 <- gsub("'", "", hh1)
hh2 <- tolower(hh1)
hh2 <- sapply(hh2, extractNoun,USE.NAMES = F)
hh2 <- Filter(function(x) {nchar(x) >= 2},hh2)
hh2
hh2 <- Filter(function(x) {nchar(x) >= 2},hh2)
hh2
hh2 <- unlist(hh2)
hh2
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),100)
hh2 <- Filter(function(x) {nchar(x) >= 2},hh2)
hh2 <- unlist(hh2)
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),100)
txt <- readLines("hiphop_gsub.txt")
cnt_txt <- length(txt)
i<-1
for (i in 1:cnt_txt) {
hh3 <- gsub((txt[i]),"",hh2)
}
hh3
wordcount <- table(hh3)
head(sort(wordcount,decreasing = T),100)
for (i in 1:cnt_txt) {
hh3 <- gsub((txt[i]),"",hh2)
}
wordcount <- table(hh3)
head(sort(wordcount,decreasing = T),100)
for (i in 1:cnt_txt) {
hh3 <- gsub((txt[i]),"",hh3)
}
wordcount <- table(hh3)
head(sort(wordcount,decreasing = T),100)
write(unlist(hh3),"rehiphop.txt")
data <- read.table("rehiphop.txt")
data <- read.table("rehiphop.txt")
hh <- readLines("hiphop.txt")
hh1 <- gsub("'\n'","", hh)
hh1 <- gsub("\'", "", hh1)
hh1 <- gsub("'", "", hh1)
hh2 <- tolower(hh1)
hh2 <- sapply(hh2, extractNoun,USE.NAMES = F)
hh2 <- unlist(hh2)
hh2
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),100)
head(sort(wordcount,decreasing = T),200)
hh2 <- Filter(function(x) {nchar(x) >= 2},hh2)
hh2 <- unlist(hh2)
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),200)
write(unlist(hh2),"rehiphop.txt")
data <- read.table("rehiphop.txt")
txt <- readLines("hiphop_gsub.txt")
cnt_txt <- length(txt)
i<-1
for (i in 1:cnt_txt) {
data1 <- gsub((txt[i]),"",data)
}
wordcount <- table(data1)
head(sort(wordcount,decreasing = T),200)
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),200)
for (i in 1:cnt_txt) {
hh2 <- gsub((txt[i]),"",hh2)
}
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),200)
for (i in 1:cnt_txt) {
hh2 <- gsub((txt[i]),"",hh2)
}
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),200)
for (i in 1:cnt_txt) {
hh2 <- gsub((txt[i]),"",hh2)
}
wordcount <- table(hh2)
head(sort(wordcount,decreasing = T),200)
write(unlist(hh2),"rehiphop.txt")
data <- read.table("rehiphop.txt")
nrow(data)
wordcount1 <- table(data)
head(sort(wordcount1,decreasing = T),30)
library(wordcloud2)
library(wordcloud)
wordcloud2(names(wordcount1), freq = wordcoun1)
wordcloud2(names(wordcount1) )
wordcloud2(names(wordcount1),freq = wordcount1, scale=c(5,1),rot.per=0.25,min.freq=2,random.order=F,random.color=T,colors=brewer.pal(n=11,name = "Set3"))
wordcloud2(names(wordcount1))
wordcloud2(wordcount1)
result <- head(sort(wordcount1,decreasing = T),30)
wordcloud2(result)
result <- head(sort(wordcount1,decreasing = T),50)
wordcloud2(result)
wordcloud2(result,size = 0.5)
wordcloud(names(result),freq = wordcount1, scale=c(5,1),
rot.per=0.25,min.freq=2,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3")))
wordcloud(names(result),freq = wordcount1, scale=c(5,1),
rot.per=0.25,min.freq=2,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(result),freq = wordcount1, scale=c(10,1),
rot.per=0.25,min.freq=2,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(result),freq = wordcount1, scale=c(10,1),
rot.per=0.5,min.freq=2,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(result),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=2,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(result),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=2,random.order=T,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(result,freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=2,random.order=T,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(result),freq = wordcount1, scale=c(5,1),
rot.per=1,min.freq=10,random.order=T,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(5,1),
rot.per=1,min.freq=10,random.order=T,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(5,1),
rot.per=1,min.freq=10,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=1,min.freq=10,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=1,min.freq=5,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=1,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.4,1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.4,1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(5,1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(10,1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.3,1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.3,1, "hiphop 노래 가사속의 단어 빈도수", cex = 10,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.3,1, "hiphop 노래 가사속의 단어 빈도수", cex = 1,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.3,1, "hiphop 노래 가사속의 단어 빈도수", cex = 1,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.3,1, "hiphop 노래 가사속의 단어 빈도수", cex = 3,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.3,1, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.1,1, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,1, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.41, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.1, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.3, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.01, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.03, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.01,0.03, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.02, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.2, "hiphop 노래 가사속의 단어 빈도수", cex = 2,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.2, "hiphop 노래 가사속의 단어 빈도수", cex = 0.3,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.2, "hiphop 노래 가사속의 단어 빈도수", cex = 0.5,fill=NA,border=NA,bg="white",
text.col="black",text.font=5, box.col="blue")
legend(0.01,0.2, "hiphop 노래 가사속의 단어 빈도수", cex = 0.5,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
legend(0.1,0.2, "hiphop 노래 가사속의 단어 빈도수", cex = 0.5,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.1,0.2, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
legend(0.05,0.2, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
legend(0.05,0.1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
legend(0.05,0.5, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
legend(0.05,0.9, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
legend(0.05,0.87, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(7,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.05,0.87, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(4,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(2,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(3.5,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.05,0.9, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
legend(0.05,0.9, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
wordcloud2(result,size = 0.5)
wordcloud(names(wordcount1),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set3"))
wordcloud(names(wordcount1),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set2"))
legend(0.05,0.9, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="blue")
legend(0.05,0.9, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
legend(0.05,1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
legend(0.05,1, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
legend(0.05,0/93, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
legend(0.05,0.93, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
legend(0.07,0.93, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
legend(0.07,0.91, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set2"))
legend(0.07,0.91, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
wordcloud(names(wordcount1),freq = wordcount1, scale=c(3,1),
rot.per=0.5,min.freq=15,random.order=F,random.color=T,
colors=brewer.pal(n=11,name = "Set2"))
legend(0.07,0.92, "hiphop 노래 가사속의 단어 빈도수", cex = 0.8,fill=NA,border=NA,bg="white",
text.col="black",text.font=3, box.col="white")
wordcloud2(result,size = 0.5)
library(dplyr)
result1 <- head(sort(wordcount1,decreasing = T),10)
df <- data.frame(result1)
pct <- round(df/sum(df) *100,1)
df
pct <- round(Freq/sum(Freq) *100,1)
pct <- round(df / sum(df) * 100,1)
library(ggplot2)
pct <- round(df / sum(df) * 100,1)
df <- data.frame(result1)
df
pct <- round(df / sum(df) * 100,1)
pct <- round(df / sum(wordcount1) * 100,1)
pct <- round(df/sum(wordcount1) * 100,1)
pct <- round(df/sum(df) * 100,1)
pct <- prop.table(table(df))
pct
pct <- prop.table(table(df$Freq))
pct
pct <- prop.table(table(result1$Freq))
pct <- round(df/sum(df))
pct <- round(df$Freq/sum(df$Freq) * 100,1)
pct
result2 <- sort(wordcount)
df1 <- data.frame(result2)
pct <- round(df$Freq/sum(df1$Freq) * 100,1)
pct
df1
pct <- round(df$Freq/sum(df1$Freq),1)
pct
pct <- round(df$Freq/sum(df1$Freq) * 100,1)
pct
rev <- read.table('rehiphop.txt')
df_top10 <- df %>%
mutate(pct = Freq / sum(Freq) * 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df_top10 <- wordcount %>%
mutate(pct = Freq / sum(Freq) * 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df_top10 <- wordcount %>%
mutate(pct = pct) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df_top10 <- df1 %>%
mutate(pct = pct) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df_top10 <- df1 %>%
mutate(pct = round(df$Freq/sum(df1$Freq) * 100,1)) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df_top10 <- df1 %>%
mutate(pct = df$Freq/sum(df1$Freq) * 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df_top10 <- df1 %>%
mutate(pct = df1$Freq/sum(df1$Freq) * 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df1 <- as.data.frame(result2)
df <- as.data.frame(result1)
df_top10 <- df1 %>%
mutate(pct = df1$Freq/sum(df1$Freq) * 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df1
pct <- round(df$Freq/sum(df1$Freq) * 100,1)
pct
df_top10 <- df1 %>%
mutate(pct_a = pct) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct_a), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct_a) - 0.5*pct)
pct <- round(df$Freq/sum(df$Freq) * 100,1)
df_top10 <- df1 %>%
mutate(pct_a = pct) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct_a), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct_a) - 0.5*pct)
df_top10 <- df %>%
mutate(pct_a = pct) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct_a), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct_a) - 0.5*pct)
df_top10 <- df %>%
mutate(pct = Freq /sum(Freq)* 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct_a), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df_top10 <- df %>%
mutate(pct = Freq /sum(Freq)* 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
df
ggplot(df1,aes(x='',y=Freq,fill=rev)) + geom_bar(stat = 'identity', width = 1) + coord_polar("y",start = 0)
rm(pct)
ggplot(df,aes(x='',y=Freq,fill=rev)) + geom_bar(stat = 'identity', width = 1) + coord_polar("y",start = 0)
ggplot(df,aes(x='',y=Freq,fill=rev)) + geom_bar(stat = 'identity', width = 1)
###그래프###
rm(df1)
###그래프###
rm(result2)
###그래프###
result1 <- head(sort(wordcount1,decreasing = T),10)
df <- as.data.frame(result1)
ggplot(df,aes(x='',y=Freq,fill=rev)) + geom_bar(stat = 'identity', width = 1) + coord_polar("y",start = 0)
ggplot(df,aes(x='',y=Freq)) + geom_bar(stat = 'identity', width = 1) + coord_polar("y",start = 0)
ggplot(df,aes(x='',y=Freq)) + geom_bar(stat = 'identity', width = 1)
df
ggplot(df,aes(y=Freq)) + geom_bar(stat = 'identity', width = 1)
ggplot(df,aes(Freq)) + geom_bar(stat = 'identity', width = 1)
ggplot(df,aes(x=Freq,y='')) + geom_bar(stat = 'identity', width = 1)
ggplot(df,aes(x=data,y=Freq)) + geom_bar(stat = 'identity', width = 1)
ggplot(df,aes(x=data,y=Freq)) + geom_bar(stat = 'identity', width = 2)
ggplot(df,aes(x=data,y=Freq)) + geom_bar(stat = 'identity', width = 0.8)
ggplot(df,aes(x=data,y=Freq)) + geom_bar(stat = 'identity', width = 0.8) + coord_polar("y",start = 0)
df_top10 <- df %>%
mutate(pct = Freq /sum(Freq) * 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
rm(pct)
df_top10 <- result1 %>%
mutate(pct = Freq /sum(Freq) * 100) %>%
mutate(ylabel = paste(sprintf("%s\n%4.1f",rev,pct), '%',sep = '')) %>%
arrange(desc(rev)) %>%
mutate(ypos = cumsum(pct) - 0.5*pct)
ggplot(df_top10, aes(x=data,y=Freq,fill=rev)) +
geom_bar(width = 1, stat = 'identity') + coord_polar("y", start = 0) +
geom_text(aes(y=ypos,label=ylabel),color='black')
ggplot(df, aes(x=data,y=Freq,fill=rev)) +
geom_bar(width = 1, stat = 'identity') + coord_polar("y", start = 0) +
geom_text(aes(y=ypos,label=ylabel),color='black')
ggplot(df, aes(x=data,y=Freq)) +
geom_bar(width = 1, stat = 'identity') + coord_polar("y", start = 0) +
geom_text(aes(y=ypos,label=ylabel),color='black')
ggplot(df, aes(x=data,y=Freq)) +
geom_bar(width = 1, stat = 'identity') + coord_polar("y", start = 0) +
ggplot(df, aes(x=data,y=Freq)) +
geom_bar(width = 1, stat = 'identity') + coord_polar("y", start = 0)
ggplot(df_top10, aes(x='',y=Freq,fill=rev)) +
geom_bar(width = 1, stat = 'identity') + coord_polar("y", start = 0) +
geom_text(aes(y=ypos,label=ylabel),color='black')
ggplot(df, aes(x='',y=Freq,fill=rev)) +
geom_bar(width = 1, stat = 'identity') + coord_polar("y", start = 0) +
geom_text(aes(y=ypos,label=ylabel),color='black')
